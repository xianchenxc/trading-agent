# 策略与回测结果

本文档记录交易策略详情、回测结果和参数优化历史。

## 策略概述

### 策略名称
基于EMA指标的趋势跟随策略

### 核心逻辑
- **趋势识别（4h周期）**：使用EMA50与EMA200判断市场趋势
  - EMA50 > EMA200 → 多头趋势
  - EMA50 < EMA200 → 空头趋势
  - 否则 → 无趋势（不交易）

- **入场信号（1h周期）**：
  - **多头入场**：
    1. 4h为多头趋势
    2. 1h EMA20 > EMA50
    3. 价格突破最近N根K线最高价（N=20）
  
  - **空头入场**：
    1. 4h为空头趋势
    2. 1h EMA20 < EMA50
    3. 价格跌破最近N根K线最低价（N=20）

- **出场条件**：
  - 止损：入场价 ± 1.5 × ATR(1h)
  - 移动止盈：价格从最高/最低回撤 ≥ 2.5 × ATR
  - 趋势反转：4h趋势反转
  - 最大持仓时间：50根K线（1h）

### 风控规则
- 单笔最大风险：账户净值的1%
- 最大持仓数：同时仅1笔
- 冷却期：连续3笔亏损后停止交易24小时

---

## 当前参数配置

### 策略参数
| 参数 | 数值 | 说明 |
|------|------|------|
| 趋势周期 | 4h | 趋势识别的时间周期 |
| 信号周期 | 1h | 入场信号的时间周期 |
| 回看周期 | 20 | 突破检测的K线数量 |
| 短期EMA | 20 | 1h信号的短期EMA |
| 中期EMA | 50 | 两个周期的中期EMA |
| 长期EMA | 200 | 4h趋势的长期EMA |
| ATR周期 | 14 | ATR计算的周期 |
| 止损倍数 | 1.5 | 止损的ATR倍数 |
| 止盈倍数 | 2.5 | 移动止盈的ATR倍数 |
| 最大持仓K线数 | 50 | 最大持仓的K线数量 |

### 风控参数
| 参数 | 数值 | 说明 |
|------|------|------|
| 单笔最大风险 | 1% | 占账户净值的最大风险比例 |
| 最大持仓数 | 1 | 最大并发持仓数 |
| 最大连续亏损 | 3 | 触发冷却期的亏损次数 |
| 冷却时长 | 24 | 达到最大亏损后的等待小时数 |

### 回测参数
| 参数 | 数值 | 说明 |
|------|------|------|
| 初始资金 | $10,000 | 起始资金 |
| 手续费率 | 0.1% | 交易手续费 |
| 滑点率 | 0.05% | 模拟滑点 |

---

## 回测结果

### 测试日期：2026-01-10

**测试周期**：2025-10-12 至 2026-01-10（90天）

**交易对**：BTCUSDT

#### 性能摘要
| 指标 | 数值 |
|------|------|
| 总收益 | -$2,574.00 |
| 总收益率 | -25.74% |
| 最大回撤 | $1,436.46 |
| 最大回撤率 | 14.36% |
| 总交易次数 | 15 |
| 盈利交易 | 2 |
| 亏损交易 | 13 |
| 胜率 | 13.33% |
| 盈亏比 | 0.14 |
| 平均盈利 | $112.26 |
| 平均亏损 | $127.77 |

#### 交易明细
| 交易# | 方向 | 入场价 | 出场价 | 盈亏 | 盈亏% | 出场原因 | 持仓时长（小时） |
|-------|------|--------|--------|------|-------|----------|------------------|
| 1 | 空头 | $94,330.28 | $96,531.01 | -$134.47 | -2.54% | 止损触发 | 1357.50 |
| 2 | 空头 | $94,526.17 | $95,337.66 | -$115.14 | -1.06% | 移动止盈 | 1314.50 |
| 3 | 空头 | $92,721.11 | $92,956.56 | -$29.55 | -0.45% | 移动止盈 | 1288.50 |
| 4 | 空头 | $90,414.76 | $91,600.74 | -$81.56 | -1.51% | 移动止盈 | 1252.50 |
| 5 | 空头 | $87,834.16 | $84,919.51 | +$200.41 | +3.12% | 移动止盈 | 1217.50 |
| 6 | 空头 | $86,956.50 | $86,912.94 | -$22.22 | -0.15% | 移动止盈 | 969.50 |
| 7 | 空头 | $85,387.92 | $86,479.87 | -$177.76 | -1.48% | 止损触发 | 957.50 |
| 8 | 空头 | $90,419.91 | $89,666.77 | +$53.56 | +0.63% | 移动止盈 | 860.50 |
| 9 | 空头 | $88,176.42 | $89,599.30 | -$287.39 | -1.82% | 止损触发 | 811.50 |
| 10 | 空头 | $89,315.32 | $89,286.94 | -$36.27 | -0.17% | 移动止盈 | 646.50 |
| 11 | 空头 | $86,989.70 | $88,021.42 | -$109.61 | -1.39% | 止损触发 | 618.50 |
| 12 | 空头 | $85,786.31 | $86,742.99 | -$112.32 | -1.32% | 止损触发 | 567.50 |
| 13 | 空头 | $84,441.55 | $85,673.77 | -$134.89 | -1.66% | 止损触发 | 542.50 |
| 14 | 空头 | $87,721.13 | $88,053.81 | -$41.03 | -0.58% | 移动止盈 | 436.50 |
| 15 | 多头 | $94,365.00 | $93,553.19 | -$109.30 | -1.06% | 止损触发 | 112.50 |

#### 结果分析
- **胜率**：13.33%，偏低，表明策略可能不适合当前市场环境
- **盈亏比**：0.14（较差，应大于1.0）
- **平均亏损 > 平均盈利**：风险收益比不利
- **趋势**：策略在该期间主要产生空头信号，但大多数被止损
- **持仓时长**：许多持仓时间过长（500+小时），表明入场可能过早

#### 发现的问题
1. 低胜率表明入场条件可能过于敏感或市场环境不利
2. 移动止盈可能过紧，导致过早出场
3. 1.5 × ATR的止损可能过宽，导致较大亏损
4. 策略可能需要针对当前市场波动性进行调整

---

## 参数优化历史

### 版本 1.0 (2026-01-10)
- 按需求文档设置的初始参数
- 测试周期：90天
- 结果：-25.74%收益率
- **状态**：需要优化

**下一步优化计划**：
- [ ] 测试不同的止损ATR倍数（尝试1.0、1.2、2.0）
- [ ] 测试不同的移动止盈ATR倍数（尝试2.0、3.0、3.5）
- [ ] 测试不同的回看周期（尝试15、25、30）
- [ ] 测试不同的EMA组合
- [ ] 在不同时间段测试
- [ ] 添加额外过滤器（成交量、波动率）

---

## 市场环境说明

### 测试周期：2025-10-12 至 2026-01-10
- 市场在该期间大部分时间处于下跌趋势
- 观察到高波动性
- 策略主要产生空头信号
- 多头信号在接近结束时出现，但很快被止损

---

## 未来改进方向

1. **策略增强**：
   - 添加成交量确认
   - 添加波动率过滤器
   - 考虑多周期确认
   - 添加支撑/阻力位

2. **风险管理**：
   - 基于波动率的动态仓位管理
   - 组合级别的风险限制
   - 多交易对相关性分析

3. **回测改进**：
   - 滚动优化
   - 蒙特卡洛模拟
   - 样本外测试
   - 不同市场状态测试

4. **实盘交易**：
   - 实现Binance API集成
   - 添加订单管理系统
   - 添加实时监控
   - 添加警报系统

---

## 备注

- 所有回测结果应在此文档中详细记录
- 参数变更应使用版本号追踪
- 测试期间的市场环境应注明
- 任何策略修改都应记录理由
